---
import Base from "@/layouts/Base.astro";
import PageHeader from "@/partials/PageHeader.astro";

const title = "AI Leadership Newsletter";
const description = "Weekly insights, exclusive content, and practical AI guidance for business leaders navigating digital transformation.";
const meta_title = "AI Leadership Newsletter - Weekly Insights for CEOs and Leaders | Kowalah";
---

<Base title={title} meta_title={meta_title} description={description}>
  <PageHeader
    title={title}
    content="Get weekly AI insights, exclusive content, and practical guidance delivered to your inbox every week."
    backgroundImage="/images/resources/newsletter_hero.png"
  />

  <section class="pt-16 md:pt-24 relative overflow-hidden">
    <div class="container">
      <div class="row justify-center">
        <!-- Newsletter Benefits -->
        <div class="col-12 lg:col-10 mb-16">
          <div class="grid md:grid-cols-3 gap-8" data-aos="fade-up-sm">
            <div class="text-center">
              <div class="w-16 h-16 bg-gradient-to-br from-primary to-secondary rounded-2xl flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-semibold mb-3">Weekly AI Insights</h3>
              <p class="text-gray-600">Stay informed with the latest AI developments, trends, and strategic implications for your business.</p>
            </div>

            <div class="text-center">
              <div class="w-16 h-16 bg-gradient-to-br from-primary to-secondary rounded-2xl flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-semibold mb-3">Exclusive Content</h3>
              <p class="text-gray-600">Access subscriber-only resources, case studies, and early announcements before they're published.</p>
            </div>

            <div class="text-center">
              <div class="w-16 h-16 bg-gradient-to-br from-primary to-secondary rounded-2xl flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-semibold mb-3">Practical Guidance</h3>
              <p class="text-gray-600">Actionable strategies and implementation tips you can apply immediately to accelerate AI adoption.</p>
            </div>
          </div>
        </div>

        <!-- Newsletter Form -->
        <div class="col-12 sm:col-10 xl:col-6 lg:col-8 mb-20">
          <!-- Success Message -->
          <div id="form-success" class="hidden mb-8 p-6 bg-green-50 border border-green-200 rounded-lg text-center">
            <svg class="w-12 h-12 text-green-600 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <h3 class="text-xl font-semibold text-green-800 mb-2">Welcome to the Community!</h3>
            <p class="text-green-700">You're now subscribed to our weekly AI leadership newsletter. Check your inbox for a confirmation email.</p>
          </div>

          <!-- Error Message -->
          <div id="form-error" class="hidden mb-8 p-6 bg-red-50 border border-red-200 rounded-lg text-center">
            <svg class="w-12 h-12 text-red-600 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <h3 class="text-xl font-semibold text-red-800 mb-2">Oops! Something went wrong.</h3>
            <p class="text-red-700">Please try again or email us at <a href="mailto:hello@kowalah.com" class="underline">hello@kowalah.com</a></p>
          </div>

          <!-- Form Header -->
          <div class="text-center mb-8" data-aos="fade-up-sm">
            <h2 class="text-2xl font-semibold mb-3">Join 1,000+ Business Leaders</h2>
            <p class="text-gray-600">Get your weekly dose of AI insights every Tuesday morning.</p>
          </div>

          <form id="newsletter-form" class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
            <div class="mb-4 flex justify-between flex-col md:flex-row gap-4">
              <div
                class="md:w-1/2 w-full"
                data-aos="fade-up-sm"
                data-aos-delay="20"
              >
                <label for="firstname" class="form-label"> First Name </label>
                <input
                  id="firstname"
                  name="firstname"
                  class="form-input"
                  placeholder="John"
                  type="text"
                  required
                />
              </div>
              <div
                class="md:w-1/2 w-full"
                data-aos="fade-up-sm"
                data-aos-delay="40"
              >
                <label for="lastname" class="form-label"> Last Name </label>
                <input
                  id="lastname"
                  name="lastname"
                  class="form-input"
                  placeholder="Smith"
                  type="text"
                  required
                />
              </div>
            </div>

            <div class="mb-6" data-aos="fade-up-sm" data-aos-delay="60">
              <label for="email" class="form-label"> Email Address </label>
              <input
                id="email"
                name="email"
                class="form-input"
                placeholder="john.smith@yourcompany.com"
                type="email"
                required
              />
            </div>

            <button
              type="submit"
              id="submit-button"
              class="btn btn-primary w-full"
              data-aos="fade-up-sm"
              data-aos-delay="80"
            >
              Subscribe to Newsletter
            </button>

            <p class="text-xs text-gray-500 text-center mt-4">
              We respect your privacy. Unsubscribe at any time. No spam, ever.
            </p>
          </form>
        </div>

        <!-- Social Proof / Additional Info -->
        <div class="col-12 lg:col-10">
          <div class="bg-gradient-to-r from-primary/5 to-secondary/5 rounded-2xl p-8 border border-primary/10" data-aos="fade-up-sm">
            <div class="text-center max-w-3xl mx-auto">
              <h3 class="text-xl font-semibold mb-4">What You'll Get</h3>
              <div class="grid md:grid-cols-2 gap-6 text-left">
                <div class="flex items-start space-x-3">
                  <div class="flex-shrink-0 w-6 h-6 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center mt-0.5">
                    <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <span><strong>Weekly AI Roundup:</strong> Curated insights on AI trends and business impact</span>
                </div>

                <div class="flex items-start space-x-3">
                  <div class="flex-shrink-0 w-6 h-6 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center mt-0.5">
                    <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <span><strong>Implementation Tips:</strong> Practical advice for AI deployment and change management</span>
                </div>

                <div class="flex items-start space-x-3">
                  <div class="flex-shrink-0 w-6 h-6 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center mt-0.5">
                    <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <span><strong>Case Studies:</strong> Real success stories from AI transformation leaders</span>
                </div>

                <div class="flex items-start space-x-3">
                  <div class="flex-shrink-0 w-6 h-6 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center mt-0.5">
                    <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <span><strong>Early Access:</strong> Be first to know about webinars, resources, and events</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Base>

<script>
  document.addEventListener("astro:page-load", () => {
    const form = document.getElementById("newsletter-form") as HTMLFormElement;
    const submitButton = document.getElementById("submit-button") as HTMLButtonElement;
    const successMessage = document.getElementById("form-success") as HTMLElement;
    const errorMessage = document.getElementById("form-error") as HTMLElement;

    // HubSpot configuration
    const PORTAL_ID = "139642758";
    const FORM_GUID = "e9bf6836-8953-4f3c-ac1a-ae1e42418657";
    const HUBSPOT_API_URL = `https://api.hsforms.com/submissions/v3/integration/submit/${PORTAL_ID}/${FORM_GUID}`;

    // Handle form submission
    form?.addEventListener("submit", async (e) => {
      e.preventDefault();

      // Disable button and show loading state
      if (submitButton) {
        submitButton.disabled = true;
        submitButton.textContent = "Subscribing...";
      }

      // Hide any previous messages
      successMessage?.classList.add("hidden");
      errorMessage?.classList.add("hidden");

      // Get form data
      const formData = new FormData(form);

      // Build HubSpot fields array
      const fields = [];
      for (const [key, value] of formData.entries()) {
        if (value) {  // Only include non-empty fields
          fields.push({
            objectTypeId: "0-1",  // Contact object
            name: key,
            value: value.toString()
          });
        }
      }

      // Prepare HubSpot submission payload
      const payload = {
        fields: fields,
        context: {
          pageUri: window.location.href,
          pageName: document.title
        }
      };

      try {
        const response = await fetch(HUBSPOT_API_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(payload),
        });

        if (response.ok) {
          // Success!
          successMessage?.classList.remove("hidden");
          form.reset();
          // Scroll to success message
          successMessage?.scrollIntoView({ behavior: "smooth", block: "center" });
        } else {
          // Error
          console.error(`HubSpot submission failed: status ${response.status}`);
          errorMessage?.classList.remove("hidden");
          errorMessage?.scrollIntoView({ behavior: "smooth", block: "center" });
        }
      } catch (error) {
        // Network error
        console.error("Form submission error:", error instanceof Error ? error.message : "Unknown error");
        errorMessage?.classList.remove("hidden");
        errorMessage?.scrollIntoView({ behavior: "smooth", block: "center" });
      } finally {
        // Re-enable button
        if (submitButton) {
          submitButton.disabled = false;
          submitButton.textContent = "Subscribe to Newsletter";
        }
      }
    });
  });
</script>
